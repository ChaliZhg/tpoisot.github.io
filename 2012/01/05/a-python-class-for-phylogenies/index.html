<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<link href="/bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
	<link href="http://netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.css" rel="stylesheet">
	<link rel="stylesheet" href="/css/main.css" />
	<link rel="stylesheet" href="/css/d3.css" />
	<link rel="stylesheet" href="/css/pygments.css" />
	<script type="text/javascript" src="//use.typekit.net/kvz6lyh.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <link rel="alternate" type="application/atom+xml" title="RSS Feed for Tim's blog" href="http://feeds.feedburner.com/timpoisot" />
    
    <script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-11830706-1']);
		_gaq.push(['_trackPageview']);

		(function() {
		 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
	
	<meta name="author" content="Tim Poisot" />
   <title>Tim Poisot :: Simulated phylogenetic trees and community assembly</title>
    
</head>

<body>

<div class="row-fluid site-head">
	<div class="span6 offset3">
	<div class="jumbotron site-header">
<h1>Tim Poisot</h1> <h2 class='muted'>Community ecologist & open scientist</h2>
</div>

	</div>
</div>

<div class="row-fluid main-nav"><div class="span6 offset3"><ul class="nav nav-pills">
  <li><a href="/"><i class="icon-fixed-width icon-home"></i> Home</a></li>
  <li><a href="/papers/"><i class="icon-fixed-width icon-book"></i> Publications</a></li>
  <li><a href="/research/"><i class="icon-fixed-width icon-beaker"></i> Research</a></li>
  <li class="active"><a href="/blog/"><i class="icon-fixed-width icon-edit"></i> Blog</a></li>
</ul>

</div></div>

<div class="row-fluid">
	
	<div class="span6 offset3 page-content">
	<div class='post-title muted'>Simulated phylogenetic trees and community assembly</div>

<p>I'm working on a toy model of community assembly in Python, and I thought it would be cool to have an easy way to keep track of the phylogeny. To do so, I've conceived two classes for the easy handling of phylogenetic structure. They are available on GitHub in the <a href="https://github.com/tpoisot/PyCoPhy"><code>PyCoPhy</code> repository</a> (Python Community Phylogenetics), and check also the <a href="/code/">code page</a>.</p>

<p>The general idea behind them is quite easy to understand. A phylogenetic tree is a list of branchings. A branching is the junction of two objects, which I called <code>left</code> and <code>right</code>. Each of these objects can be an identifier (i.e. a leaf of the tree), or a reference to another branching (i.e. a node). It's as complicated as it gets.</p>

<p>Once <code>PyCoPhy</code> is loaded, to create a new tree with a species called <code>ancestor</code>, just type:</p>

<div class="highlight"><pre><code class="python"><span class="n">iTree</span> <span class="o">=</span> <span class="n">PhyloTree</span><span class="p">(</span><span class="s">&#39;ancestor&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">iTree</span>
</code></pre></div>


<p>The output of this command should be <code>(root, ancestor)</code>. The <code>root</code> is created by default to ensure that the most basal node is a branching. The interesting thing is that it's now relatively easy to add and remove species. The <code>PhyloTree</code> class has the <code>speciate</code> method, who takes two arguments: the name of the ancestor, and the name of the daughter species. Calling it will go through the tree, and replace the ancestor by the (ancestor, daughter species) branching. Let's try with:</p>

<div class="highlight"><pre><code class="python"><span class="n">iTree</span> <span class="o">=</span> <span class="n">PhyloTree</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span>
<span class="n">iTree</span><span class="o">.</span><span class="n">speciate</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;0_0&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">iTree</span>
</code></pre></div>


<p>which results in the following tree: <code>(root,(0,0_0))</code>. And I know this is not the way speciation works, so there is also a <code>split</code> method, which will replace one ancestral species by two new species:</p>

<div class="highlight"><pre><code class="python"><span class="n">iTree</span> <span class="o">=</span> <span class="n">PhyloTree</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span>
<span class="n">iTree</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">iTree</span>
</code></pre></div>


<p>will result in <code>(root,(2,1))</code>. This is all made possible by the <code>extinct</code> method, by the way, which will remove from the tree the species whose name is given in argument:</p>

<div class="highlight"><pre><code class="python"><span class="n">iTree</span> <span class="o">=</span> <span class="n">PhyloTree</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span>
<span class="n">iTree</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">)</span>
<span class="n">iTree</span><span class="o">.</span><span class="n">extinct</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">iTree</span>
</code></pre></div>


<p>will result in <code>(root,1)</code>.</p>

<p>Although these classes are really basic at the moment, they allow me to easily keep track of who is related to who in my simulations. I'll most likely add a way to keep track of branch lenghts at some point in the near future.</p>


<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'tpoi-hp'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<ul class="pager">


<li class="previous">
<a href="/2012/01/01/migration-to-jekyll/">&larr; Previous post</a>
</li>



<li class="next">
<a href="/2012/01/06/science-age-social-coding/">Next post &rarr;</a>
</li>


</ul>


	</div>
	
	<div class="span2">
	
	January  5, 2012<br />
386 words <br />	
<p />

<span class="label label-default">python</span>

<span class="label label-default">ecological networks</span>

<span class="label label-default">phylogeny</span>


	
	</div>
		
</div>

<div class="row-fluid footer">
	<div class="span6 offset3">
	  <p class="muted credit">
	  This website uses <a href='http://twitter.github.io/bootstrap/index.html'>bootstrap</a>, <a href='http://fortawesome.github.io/Font-Awesome/'>Font Awesome</a>, is built with <a href='https://github.com/mojombo/jekyll'>Jekyll</a>, and hosted by <a href='http://pages.github.com/'>GitHub pages</a>. Contents under the <a href='http://creativecommons.org/licenses/by-sa/3.0/deed.en_US'>CC BY-SA 3.0</a> licence.
	  </p>	 
<ul class="nav nav-pills">	  
<li><a href="mailto:timothee_poisot@uqar.ca"><i class="icon-fixed-width icon-envelope"></i> email</a></li>
<li><a href="http://feeds.feedburner.com/timpoisot"><i class="icon-fixed-width icon-rss"></i> rss</a></li>
<li><a href="https://github.com/tpoisot/"><i class="icon-fixed-width icon-github"></i> github</a></li>
<li><a href="https://twitter.com/tpoi/"><i class="icon-fixed-width icon-twitter"></i> twitter</a></li>
<li><a href="http://bit.ly/UbDlP0"><i class="icon-fixed-width icon-picture"></i> figshare</a></li>
</ul>
</div>
</div>

</body>

</html>
