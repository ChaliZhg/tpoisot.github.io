
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="author" content="Tim Poisot" />
    <title>Tim Poisot :: Simulated phylogenetic trees and community assembly</title>

    <link rel="stylesheet" href="/assets/themes/thescientist/css/core.css" media="screen"/> 
    <link rel="stylesheet" href="/assets/themes/thescientist/css/mobile.css" media="handheld, only screen and (max-device-width:480px)"/>
    <link rel="stylesheet" href="/assets/themes/thescientist/css/pygment.css" />
    
    <script type="text/javascript" src="//use.typekit.net/kvz6lyh.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    
      <link rel="alternate" type="application/atom+xml" title="RSS Feed for Tim's blog" href="http://feeds.feedburner.com/timpoisot" />
    

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    
  </head>
  <body>
    <div class="wrapper">
      <div class='precontent'>
        <div class='siteinfos'>
          <h1><a href="http://timotheepoisot.fr">Tim Poisot</a></h1>
          <div class='nav'>
          <ul class='main-nav'>
            <li><a class="extra navlink" href="/">About me</a></li>
            <li><a class="extra navlink" href="/papers/">Papers</a></li>
            <li><a class="extra navlink" href="/code/">Code</a></li>     
            <li><a class="extra navlink" href="/blog/">Blog</a></li>
          </ul>
          
            <ul class='sec-nav'>
              
              <li class="contact navlink"><a href="mailto:timothee.poisot@uqar.ca" rel="me">Email</a></li>
              
              
              <li class="github navlink"><a href="http://github.com/tpoisot/" rel="me">GitHub</a></li>
              
              
              <li class="twitter navlink"><a href="http://twitter.com/tpoi/" rel="me">Twitter</a></li>
              
              
              <li class="mendeley navlink"><a href="http://www.mendeley.com/profiles/tim-poisot/" rel="me">Mendeley</a></li>
              
              
              
              <li class="figshare navlink"><a href="http://bit.ly/UbDlP0" rel="me">FigShare</a></li>
              
            </ul>
          
        </div>
        </div>
      </div>

      <section class='content'>
      
<section>
	<div class='pbody'>

		<h1 class='ptitle'>Simulated phylogenetic trees and community assembly</h1>

		<div class='postinfo'>
			January  5, 2012 &mdash;
			
				<a class='post-tag' href="/tags/#python-ref" title="tag">python</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#ecological networks-ref" title="tag">ecological networks</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#phylogeny-ref" title="tag">phylogeny</a>
			
		</div>

		<p>I'm working on a toy model of community assembly in Python, and I thought it would be cool to have an easy way to keep track of the phylogeny. To do so, I've conceived two classes for the easy handling of phylogenetic structure. They are available on GitHub in the <a href="https://github.com/tpoisot/PyCoPhy"><code>PyCoPhy</code> repository</a> (Python Community Phylogenetics), and check also the <a href="/code/">code page</a>.</p>

<p>The general idea behind them is quite easy to understand. A phylogenetic tree is a list of branchings. A branching is the junction of two objects, which I called <code>left</code> and <code>right</code>. Each of these objects can be an identifier (i.e. a leaf of the tree), or a reference to another branching (i.e. a node). It's as complicated as it gets.</p>

<p>Once <code>PyCoPhy</code> is loaded, to create a new tree with a species called <code>ancestor</code>, just type:</p>

<div class="highlight"><pre><code class="python"><span class="n">iTree</span> <span class="o">=</span> <span class="n">PhyloTree</span><span class="p">(</span><span class="s">&#39;ancestor&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">iTree</span>
</code></pre>
</div>


<p>The output of this command should be <code>(root, ancestor)</code>. The <code>root</code> is created by default to ensure that the most basal node is a branching. The interesting thing is that it's now relatively easy to add and remove species. The <code>PhyloTree</code> class has the <code>speciate</code> method, who takes two arguments: the name of the ancestor, and the name of the daughter species. Calling it will go through the tree, and replace the ancestor by the (ancestor, daughter species) branching. Let's try with:</p>

<div class="highlight"><pre><code class="python"><span class="n">iTree</span> <span class="o">=</span> <span class="n">PhyloTree</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span>
<span class="n">iTree</span><span class="o">.</span><span class="n">speciate</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;0_0&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">iTree</span>
</code></pre>
</div>


<p>which results in the following tree: <code>(root,(0,0_0))</code>. And I know this is not the way speciation works, so there is also a <code>split</code> method, which will replace one ancestral species by two new species:</p>

<div class="highlight"><pre><code class="python"><span class="n">iTree</span> <span class="o">=</span> <span class="n">PhyloTree</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span>
<span class="n">iTree</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">iTree</span>
</code></pre>
</div>


<p>will result in <code>(root,(2,1))</code>. This is all made possible by the <code>extinct</code> method, by the way, which will remove from the tree the species whose name is given in argument:</p>

<div class="highlight"><pre><code class="python"><span class="n">iTree</span> <span class="o">=</span> <span class="n">PhyloTree</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span>
<span class="n">iTree</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">)</span>
<span class="n">iTree</span><span class="o">.</span><span class="n">extinct</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">iTree</span>
</code></pre>
</div>


<p>will result in <code>(root,1)</code>.</p>

<p>Although these classes are really basic at the moment, they allow me to easily keep track of who is related to who in my simulations. I'll most likely add a way to keep track of branch lenghts at some point in the near future.</p>


		<div id="page-navigation">

        		<div class="left">
	        		
	                	Previous post: <a href="/2012/01/01/migration-to-jekyll/" title="Previous Post: Goodbye Wordpress, hello Jekyll!">Goodbye Wordpress, hello Jekyll!</a>
	        		
        		</div>

		        <div class="right">
			        
			                Next post: <a href="/2012/01/06/science-age-social-coding/" title="Next Post: Science in the age of social coding">Science in the age of social coding</a>
			        
		        </div>
		</div> 

		


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'tpoi-hp'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




	</div>
</section>

      </section>

      <div class='footer'>
          <p>
            This website uses <a href="http://jekyllbootstrap.com/">Jekyll Bootstrap</a>, the <a href="https://developers.google.com/webfonts/">Google Fonts API</a>, and is hosted at <a href="http://pages.github.com/">GitHub pages</a>.
          </p>
      </div>
      
    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>

