<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
      <title>Timothée Poisot | Teaching isoclines in the two-species competitive logistic model</title>
		<meta name="description" content="Blueprint: Slide and Push Menus" />
		<meta name="keywords" content="sliding menu, pushing menu, navigation, responsive, menu, css, jquery" />
		<meta name="author" content="Codrops" />
		<link rel="shortcut icon" href="../favicon.ico">
		<link rel="stylesheet" type="text/css" href="/styles/default.css" />
		<link rel="stylesheet" type="text/css" href="/styles/component.css" />
		<link rel="stylesheet" type="text/css" href="/styles/style.css" />
      <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
		<script src="/js/modernizr.custom.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

	</head>
	<body class="cbp-spmenu-push">
		<nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1">
			<h3>Menu</h3>
         <p>Timothée Poisot is a numerical and computational ecologist interested in developing predictive approaches to the structure of ecological communities. He uses tools from graph theory and network analysis in addition to more classical ecological approaches.</p>
			<a href="/research/">Research</a>
			<a href="/software/">Software</a>
			<a href="/blog/">Blog</a>
			<a href="/papers/">Papers</a>
			<a href="/">Home</a>
		</nav>
      <span class='menu'>
			<a id="showLeft"><i class="fa fa-bars"></i></a>
      </span>
		<div class="container">
			<header class="clearfix">
            
            <span>March 18, 2014</span>
            <h1>Teaching isoclines in the two-species competitive logistic model</h1>
            
         </header>
			<div class="main">
            <span class="content">
               <p>I’ve had a great discussion by email with <a href="http://www.crystalernst.com/">Crystal Ernst</a>, about the
best way to teach isoclines and phase portraits to undergraduates. I had
this discussion countless times over the last two years, and I struggled
when I had to teach that myself. I ended up finding a little twist on the
classical diagrams, and so I decided that it was time to share it.</p>

<p>Isoclines are usually first introduced when discussing the logistic model with competition between two species, or</p>

<script type="math/tex; mode=display">
\dot N_1 = N_1 r_1 \left(1 - \frac{\alpha_{11}N_1+\alpha_{12}N_2}{K_1} \right)
</script>

<script type="math/tex; mode=display">
\dot N_2 = N_2 r_2 \left(1 - \frac{\alpha_{22}N_2+\alpha_{21}N_1}{K_2} \right)
</script>

<p>It’s an important model, as we can use it as a gateway to talk about
coexistence, local stability, and ecosystem functioning. It is also a perfect
transition between the empirical side of ecology with Gauses’s experiments, and
the more theoretical side of it. I <em>love</em> this model, especially for teaching.</p>

<p>There are a number of intersting things to explain to students when introducing
this model. First, each species <script type="math/tex"> n </script> perceives its environment
as a “box” with <script type="math/tex"> K_n </script> compartments. Left to their own devices,
each “individual” (or units of biomass) will “fill” <script type="math/tex">\alpha_{nn}</script>
compartments, which usually equates unity for a single species model. The
growth of the population is therefore a quest for free compartments to fill,
and when most of the box is filled, the effective growth rate decreases. When
all compartments are filled (<script type="math/tex">N_n = K_n</script>), then the growth rate is
0, and the population is at equilibrium. Cue a discussion on the mechanisms
that would allow us to represent the environment as a box with compartments
(space requirements, having enough to eat, foraging area, and whatever else
you can think of).</p>

<p>The point with introducing a second species is that there are now
two types of organisms to share the same “box”. And individuals from
species <script type="math/tex">p</script> are <em>perceived</em> by those of species <script type="math/tex">n</script>
as taking up <script type="math/tex">\alpha_{np}</script> compartments. The opposite is true,
and we can define values for the intensity of <em>intra</em> and <em>inter</em> specific
competition. The question is, then, what are the combinations of values of
<script type="math/tex">\mathbf{\alpha}</script> that allows coexistence, competitive exclusion,
or make the system sensitive to initial conditions?</p>

<p>It’s at this point that I usually introduce the notion of <em>equilibrium</em>,
<em>i.e.</em> a state of the system in which the two populations <em>stop growing</em>. The
calculus-based solution is to find values of the population densities that
make the two derivatives null at the same time. When you are a facing
a class of undergrads that are not especially enamored with mathematics
(<a href="https://peerj.com/articles/285/">potentially a large part of the population</a>), this approach is not
likely to get them excited. Which is partly why we usually use <em>isoclines</em>
and <em>phase portraits</em> to explain how different combinations of intra/inter
specific competition strenghts affect the potential for coexistence.</p>

<p>The problem is, <strong>explaining how isoclines work is awful</strong>. I know many
people that are able to predict a <em>lot</em> of things just by drawing a bunch of
lines on a whiteboard. Did I say many? Well if the discussions I had with
people are to be believe, these are actually the happy few. The rest of us
are left scratching our head in front a cryptic diagram that makes absolutly
no sense. I blame the difficulty to read isoclines as the single reason for
which adaptive dynamics is frwoned upon by many people (that, and the fact
that any method involving third order derivatives is rapidly messy).</p>

<p>So here is my solution: <strong>use vector fields</strong>. With a vector field, it’s
virtually impossible to screw up the explanation, because all you have to do
is (i) put your finger somewhere on the diagram and (ii) follow the arows
until the equilibrium that the system would eventually reach. Want to know
how a perturbation affects this equilibrium? Just jiggle your finger a bit,
and go back to step (i). Did you ended up at the same point? Congratulations,
that’s local stability.</p>

<p>OK, so what’s a vector field? The phase portrait of the system is defined by
two axes, one for the density of species <em>1</em>, the other for the density of
species <em>2</em>. The isoclines are the lines going trough the two equilibria for
species <em>1</em> (<script type="math/tex">N_1 = (0; N^\star_1)</script>), and trough the two equilibria for
species <em>2</em> (<script type="math/tex">N_2 = (0; N^\star_2)</script>). When you are <em>above</em> (axis-wise)
your isocline, you converge back to it, and where you are <em>below</em> your
isocline, well, the same thing happens but in the other direction. At the
intersection of the two isoclines is the <em>two-species equilibrium</em>, whose
stability and accessibility tells whether coexistence is possible or not.</p>

<p>The important thing to keep in mind is that both species will push the system
in (possibly) different directions at the same time. So there can be some funky
behavior happening, and species can cross their isoclines (this happens in the
predator-prey Lotka-Volterra model, among many others). So what matters is the
<em>combined</em> changed in the system, which we can model through the addition of
two vectors in the <script type="math/tex">N_1,N_2</script> plane. The first vector (which describes
the amount of change in the <em>vertical</em> direction is <script type="math/tex">\vec{N_2}</script>. The
norm of this vector is simply <script type="math/tex">\frac{d}{dt}N_2</script>. The second vector, in
the <em>horizontal</em> direction, is similarly <script type="math/tex">\vec{N_1}</script>. The resulting
vector describing the overall change in the system is</p>

<script type="math/tex; mode=display">
\vec{S} = \vec{N_1} + \vec{N_2}
</script>

<p>Because <script type="math/tex">\vec{N_1}</script> and <script type="math/tex">\vec{N_2}</script> are orthogonal (and
because of a couple of other assumptions, such as the space defined by the
population densities being Euclidean), it’s easy to measure the Euclidean
norm of <script type="math/tex">\vec{S}</script>, which is to say the total amount of change in
the system, as being</p>

<script type="math/tex; mode=display">
\lVert \vec{S} \rVert = \sqrt{\lVert \vec{N_1} \rVert ^2 + \lVert \vec{N_2} \rVert ^2 }
</script>

<p>At any given coordinate <script type="math/tex">(N_1, N_2)</script>, the system will move towards
<script type="math/tex">(N_1 + \dot{N_1}, N_2 + \dot{N_2})</script>. With both infos in hand, we
can do two things. First, we can plot the instantaneous rate of change of the
system (the absolute value of the norm of <script type="math/tex">\vec{S}</script>) over space,
to see in which combinations of populations densities are trigerring rapid
changes. Second, we can plot the direction of change using arrows <em>over</em>
the previous graph, to see in which direction the system is moving. The
really good thing with this method is that we only have to tell students
that we describe the cumulative change of populations on the two axes,
and leave aside all of the maths (as straightforward as they may be).</p>

<p>So now, we can produce a graph like the one below:</p>

<p class="left"><img src="/images/isoclines.png" alt="Is1" /></p>

<p>When the color is close to red, the system is moving extremely fast. When the
color is close to yellow, the system is slowing down. Each arrow gives the
direction in which the system is changing, so we can see that the outcome
of competition in this case will depend on the initial conditions. It’s
also easy to start from anywhere on the plan, and follow the direction of
the arrows. You can also zoom in, to see how the system behaves when near
the equilibrium, and investigate the effects of a small disturbance. In
this case, it’s clear that the system will move away from the equilibrium,
which is a good way to introduce the notion of local stability (after that,
it’s eigenvalues all the way down!).</p>

<p class="right"><img src="/images/isoclines_stable.png" alt="Is2" /></p>

<p>The same visualization with a stable coexistence is also extremely clear. You
can easily see that all of the arrows converge towards the two-species
equilibrium, which in that case is stable. I’m not going to show the systematic
exclusion scenario, but it’s working in the same way.</p>

<p>The good thing with this method is that (i) it’s easy to explain what isoclines
are and how to use them to see how the system will change over time, and (ii)
as it’s extremely visual, it does not rely on the students understanding the
maths <em>before</em> they understand their ecological meaning. I have no data to
back this up, but I think it’s easier to understand the maths once you can
see the output in a visual way.</p>

<p>The code I used is available as a <a href="https://gist.github.com/tpoisot/9632093">gist</a>. It’s not optimized <em>at all</em>
but it runs fast enough that optimization is not really an issue. You can
modify the <code>params</code> array to fix values of <em>r</em>, <em>K</em>, and the <em>per capita</em>
competition rates, and the code will do the rest.</p>

<hr />

<p>Here we are. This is the way I currently explain isoclines, and the outcome of
competition in the two-species logistic growth model (and a bunch of others,
actually). It helps <em>me</em> by making it virtually impossible to fail at the
explanation, because I can just follow the arrows. And I think it helps <em>the
students</em> because (i) it gives a visual explanation of the phenomenon that
requires no mathematical understanding, and (ii) it’s an intuitive way to
start thinking about all the conclusions we can draw using this model.</p>

<p>Now, if any of you have an alternative method to teach that, I’m very
interested. I think that the behavior of this model can be tricky to
explain. Yet it touches upon so many core principles in community ecology
that it’s super important that we get it right.</p>




<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'tpoi-hp'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


            </span>
				<section style="display:none;">
					<h2>Slide Menus</h2>
					<!-- Class "cbp-spmenu-open" gets applied to menu -->
					<button id="showLeft">Show/Hide Left Slide Menu</button>
					<button id="showRight">Show/Hide Right Slide Menu</button>
					<button id="showTop">Show/Hide Top Slide Menu</button>
					<button id="showBottom">Show/Hide Bottom Slide Menu</button>
				</section>
			</div>
		</div>
		<!-- Classie - class helper functions by @desandro https://github.com/desandro/classie -->
		<script src="/js/classie.js"></script>
		<script>
			var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
				menuRight = document.getElementById( 'cbp-spmenu-s2' ),
				menuTop = document.getElementById( 'cbp-spmenu-s3' ),
				menuBottom = document.getElementById( 'cbp-spmenu-s4' ),
				showLeft = document.getElementById( 'showLeft' ),
				showRight = document.getElementById( 'showRight' ),
				showTop = document.getElementById( 'showTop' ),
				showBottom = document.getElementById( 'showBottom' ),
				showLeftPush = document.getElementById( 'showLeftPush' ),
				showRightPush = document.getElementById( 'showRightPush' ),
				body = document.body;

			showLeft.onclick = function() {
				classie.toggle( this, 'active' );
				classie.toggle( menuLeft, 'cbp-spmenu-open' );
				disableOther( 'showLeft' );
			};
			showRight.onclick = function() {
				classie.toggle( this, 'active' );
				classie.toggle( menuRight, 'cbp-spmenu-open' );
				disableOther( 'showRight' );
			};
			showTop.onclick = function() {
				classie.toggle( this, 'active' );
				classie.toggle( menuTop, 'cbp-spmenu-open' );
				disableOther( 'showTop' );
			};
			showBottom.onclick = function() {
				classie.toggle( this, 'active' );
				classie.toggle( menuBottom, 'cbp-spmenu-open' );
				disableOther( 'showBottom' );
			};
			showLeftPush.onclick = function() {
				classie.toggle( this, 'active' );
				classie.toggle( body, 'cbp-spmenu-push-toright' );
				classie.toggle( menuLeft, 'cbp-spmenu-open' );
				disableOther( 'showLeftPush' );
			};
			showRightPush.onclick = function() {
				classie.toggle( this, 'active' );
				classie.toggle( body, 'cbp-spmenu-push-toleft' );
				classie.toggle( menuRight, 'cbp-spmenu-open' );
				disableOther( 'showRightPush' );
			};

			function disableOther( button ) {
				if( button !== 'showLeft' ) {
					classie.toggle( showLeft, 'disabled' );
				}
				if( button !== 'showRight' ) {
					classie.toggle( showRight, 'disabled' );
				}
				if( button !== 'showTop' ) {
					classie.toggle( showTop, 'disabled' );
				}
				if( button !== 'showBottom' ) {
					classie.toggle( showBottom, 'disabled' );
				}
				if( button !== 'showLeftPush' ) {
					classie.toggle( showLeftPush, 'disabled' );
				}
				if( button !== 'showRightPush' ) {
					classie.toggle( showRightPush, 'disabled' );
				}
			}
		</script>
	</body>
</html>
