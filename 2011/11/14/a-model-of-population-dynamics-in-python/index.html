
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="author" content="Timothée Poisot" />
    <title>Tim Poisot :: A model of population dynamics in Python</title>

    <link rel="stylesheet" href="/assets/themes/thescientist/css/core.css" media="screen"/> 
    <link rel="stylesheet" href="/assets/themes/thescientist/css/mobile.css" media="handheld, only screen and (max-device-width:480px)"/>
    <link rel="stylesheet" href="/assets/themes/thescientist/css/pygment.css" />
    
    <script type="text/javascript" src="//use.typekit.net/kvz6lyh.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
    <script src="http://d3js.org/d3.v3.min.js"></script>

    
      <link rel="alternate" type="application/atom+xml" title="RSS Feed for Tim's blog" href="http://feeds.feedburner.com/timpoisot" />
    

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11830706-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </head>
  <body>
    <div class="wrapper">
      <div class='precontent'>
        <div class='siteinfos'>
          <h1><a href="http://timotheepoisot.fr">Tim Poisot</a></h1>
          <div class='nav'>
          <ul class='main-nav'>
            <li><a class="extra navlink homelink" href="/">About</a></li>
            <li><a class="extra navlink reslink" href="/research/">Research</a></li>
            <li><a class="extra navlink paplink" href="/papers/">Papers</a></li>
            <li><a class="extra navlink codelink" href="/code/">Code</a></li>     
            <li><a class="extra navlink bloglink" href="/blog/">Blog</a></li>
          </ul>
        </div>
        </div>
      </div>

      <section class='content'>
      
<section>
	<div class='pbody'>

		<h1 class='ptitle'>A model of population dynamics in Python</h1>
		<span class='margin'>
			November 14, 2011<br />
			501 words <br />	
			Taggs:
			
				<a class='post-tag' href="/tags/#python-ref" title="tag">python</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#R-ref" title="tag">R</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#scipy-ref" title="tag">scipy</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#simecol-ref" title="tag">simecol</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#simulations-ref" title="tag">simulations</a>
			
		</span>

		<p>I've been using <a href="http://python.org/">Python</a> more and more to do various things. When compared to <a href="http://cran.cict.fr/">R</a> (which I use a lot), Python is not more difficult to write, and a whole lot faster. I've started exploring tools to use Python for ecological simulations, and specifically the <a href="http://www.scipy.org/">scipy</a> library. In R, my usual tool is the <a href="http://simecol.r-forge.r-project.org/">simecol</a> package, which implements a lot of numerical integrators, and most notably <a href="http://www.oecd-nea.org/tools/abstract/detail/uscd1227"><code>LSODA</code></a> (which is awesome for many many reasons, including but not limited to its ability to switch between stiff and non-stiff problem at each step).</p>

<p>In simecol, modeling a population dynamics requires to write a function taking as an input a vector of population sizes, some parameters, and the time. The purpose of the package is to provide a wrapper around such functions. After using this package more or less non stop for 3 years, I've become accustomed to this way of writing things, and I was afraid that I may have to change my habits. I was really happy to discover that <a href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html">scipy.integrate.odeint</a> in scipy, was both an implementation of the LSODA, and worked in the exact same way that simecol did.</p>

<p>To write a simulation of population dynamics (I'll use logistic growth as an example), we first import the relevant parts of the scipy library.</p>

<div class="highlight"><pre><code class="python"><span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="kn">as</span> <span class="nn">sp_int</span>
</code></pre></div>


<p>Next, we write the function modeling the population growth, as a function of
two parameters, <em>r</em> and <em>K</em>.</p>

<div class="highlight"><pre><code class="python"><span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
    <span class="n">dY</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dY</span><span class="p">]</span>
</code></pre></div>


<p>The syntax is relatively easy. Note that <code>t0</code> is not used by the function at any time, but is required by <code>odeint</code> to do its internal calculations. Note also that y is an array. These two parameters are required, and the other are optional. Next, we fix the values of <em>r</em> and <em>K</em>. The required format is a tuple, so you need to be very careful when passing the parameters: they must be in the same order than in the function declaration. Additionally, we'll declare a starting population size.</p>

<div class="highlight"><pre><code class="python"><span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span>
</code></pre></div>


<p>Now we will do the actual numerical integration. This is fairly simple.</p>

<div class="highlight"><pre><code class="python"><span class="n">log_growth</span> <span class="o">=</span> <span class="n">sp_int</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span>
    <span class="n">func</span><span class="o">=</span><span class="n">logistic</span><span class="p">,</span><span class="n">y0</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">t</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">600</span><span class="p">),</span><span class="n">args</span><span class="o">=</span><span class="n">params</span>
    <span class="p">)</span>
</code></pre></div>


<p>Note that we define an array called <code>t</code>, in which the times at which integration needs to be performed are stored. The object <code>log_growth</code> will have all the information required to analyze the simulation results, with the time in the first column, and the population sizes after. This kind of object is fairly easy to plot using, e.g. <a href="http://pyx.sourceforge.net/">PyX</a>.</p>

<p>Although this was a simple example, it illustrates how easy it can be to program a simple simulation using python. I must admit that I was nicely surprised to see the rapidity of the process, and the gain in execution time when compared to R is definitely not something to neglect.</p>


		<div id="page-navigation">

        		<div class="left">
	        		
	                	Previous post: <a href="/2011/10/12/morpho-phylo-lamellodiscus/" title="Previous Post: Morphology and phylogeny in Lamellodiscus">Morphology and phylogeny in Lamellodiscus</a>
	        		
        		</div>

		        <div class="right">
			        
			                Next post: <a href="/2011/11/19/get-your-lab-on-twitter/" title="Next Post: Get your lab on twitter!">Get your lab on twitter!</a>
			        
		        </div>
		</div> 

		


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'tpoi-hp'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




	</div>
</section>
<span
	class="Z3988" 
	title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc&amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator&amp;rft.title=A model of population dynamics in Python&amp;rft.creator=Timothée Poisot&amp;rft.date=2011-11-14&amp;rft.language=EN&amp;rft.rights=CC-BY-SA&amp;rft_id=http://timotheepoisot.fr/2011/11/14/a-model-of-population-dynamics-in-python/">
</span>

      </section>

      <div class='footer'>
          <p>
            This website uses <a href="http://jekyllbootstrap.com/">Jekyll Bootstrap</a> and is hosted at <a href="http://pages.github.com/">GitHub pages</a>.<p />
            The contents of this website are under the <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons</a> BY-SA licence 3.0.
          </p>
      </div>
      
    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>

